<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mode Estimation · SequentialSamplingModels</title><meta name="title" content="Mode Estimation · SequentialSamplingModels"/><meta property="og:title" content="Mode Estimation · SequentialSamplingModels"/><meta property="twitter:title" content="Mode Estimation · SequentialSamplingModels"/><meta name="description" content="Documentation for SequentialSamplingModels."/><meta property="og:description" content="Documentation for SequentialSamplingModels."/><meta property="twitter:description" content="Documentation for SequentialSamplingModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SequentialSamplingModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SequentialSamplingModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Single Choice Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ex_gaussian/">Ex-Gaussian</a></li><li><a class="tocitem" href="../shifted_lognormal/">Shifted Log Normal</a></li><li><a class="tocitem" href="../wald/">Wald</a></li><li><a class="tocitem" href="../wald_mixture/">Wald Mixture</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Multi-choice Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-2-1"><span class="docs-label">Single Attribute Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DDM/">Drift Diffusion Model (DDM)</a></li><li><a class="tocitem" href="../lca/">Leaky Competing Accumulator (LCA)</a></li><li><a class="tocitem" href="../lba/">Linear Ballistic Accumulator (LBA)</a></li><li><a class="tocitem" href="../lnr/">Log Normal Race (LNR)</a></li><li><a class="tocitem" href="../poisson_race/">Poisson Race</a></li><li><a class="tocitem" href="../rdm/">Racing Diffusion Model (RDM)</a></li><li><a class="tocitem" href="../stDDM/">Starting-time Drift Diffusion Model (stDDM)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2-2"><span class="docs-label">Multi-attribute Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../maaDDM/">Muti-attribute Attentional Drift Diffusion Model</a></li><li><a class="tocitem" href="../mdft/">Multi-attribute Decision Field Theory</a></li><li><a class="tocitem" href="../mlba/">Multi-attribute Linear Ballistic Accumulator</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Alternative Geometries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../cddm/">Circular Drift Diffusion Model (CDDM)</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Parameter Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Mode Estimation</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Generate-Data"><span>Generate Data</span></a></li><li><a class="tocitem" href="#Define-Turing-Model"><span>Define Turing Model</span></a></li><li><a class="tocitem" href="#Set-Parameter-Bounds"><span>Set Parameter Bounds</span></a></li><li><a class="tocitem" href="#MLE"><span>MLE</span></a></li><li><a class="tocitem" href="#MAP"><span>MAP</span></a></li><li><a class="tocitem" href="#Accessing-Estimates"><span>Accessing Estimates</span></a></li><li><a class="tocitem" href="#Seeding-MCMC-Sampler"><span>Seeding MCMC Sampler</span></a></li></ul></li><li><a class="tocitem" href="../turing_simple/">Simple Bayesian Model</a></li><li><a class="tocitem" href="../turing_advanced/">Advanced Model Specification</a></li><li><a class="tocitem" href="../turing_hierarchical/">Hierarchical Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Comparison</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bayes_factor/">Bayes Factors</a></li><li><a class="tocitem" href="../loo_compare/">PSIS-LOO</a></li></ul></li><li><a class="tocitem" href="../predictive_distributions/">Predictive Distributions</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Plotting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basic_plot_example/">Basic Example</a></li><li><a class="tocitem" href="../layout/">Changing the Layout</a></li><li><a class="tocitem" href="../plot_model/">Plot Model Process</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../developer_guide/">Developer Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameter Estimation</a></li><li class="is-active"><a href>Mode Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mode Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl/blob/master/docs/src/mode_estimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mode-Estimation"><a class="docs-heading-anchor" href="#Mode-Estimation">Mode Estimation</a><a id="Mode-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Mode-Estimation" title="Permalink"></a></h1><p>Mode estimation can be useful when full Bayesian inference is not desired, or when one wishes to initialize an MCMC sampling algorithm near the mode of the posterior distribution. Below, we show how to estimate the mode of a posterior distribution using <a href="https://github.com/TuringLang/Turing.jl">Turing&#39;s</a> capabilities for maximum likelihood estimation (MLE) and maximum a postiori (MAP).</p><h1 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h1><p>For this simple example, we will estimate the mode of the posterior distribution of the <a href="https://itsdfish.github.io/SequentialSamplingModels.jl/dev/wald/">Wald</a> model. In the code block below, we will load the required packages. </p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Turing
using SequentialSamplingModels
using Random
Random.seed!(654)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Generate-Data"><a class="docs-heading-anchor" href="#Generate-Data">Generate Data</a><a id="Generate-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-Data" title="Permalink"></a></h2><p>We will generate 50 simulated reaction times from the Wald model. </p><pre><code class="language-julia hljs">n_samples = 50
rts = rand(Wald(ν=1.5, α=.8, τ=.3), n_samples)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50-element Vector{Float64}:
 0.44084717713321875
 0.48233068283261565
 2.9421882348607427
 0.4548218665621125
 0.47720468095760876
 0.6335678966495255
 0.5304139764154272
 1.9661160747286108
 1.1620901930432856
 1.0297259138620583
 ⋮
 0.6182079534737719
 1.091426832910844
 0.5867650332067396
 0.3868217393643972
 0.5797363367304815
 0.5788597335382517
 1.0494118344927919
 0.5993949693403885
 0.40958047222229915</code></pre><h2 id="Define-Turing-Model"><a class="docs-heading-anchor" href="#Define-Turing-Model">Define Turing Model</a><a id="Define-Turing-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Turing-Model" title="Permalink"></a></h2><p>Below, we define a Turing model with prior distributions specified. Note that the prior  distributions are only applicable to MAP.</p><pre><code class="language-julia hljs">@model function model(rts; min_rt = minimum(rts))
    ν ~ truncated(Normal(1.5, 1), 0, Inf)
    α ~ truncated(Normal(.8, 1), 0, Inf)
    τ ~ Uniform(0, min_rt)
    rts ~ Wald(ν, α, τ)
    return (;ν, α, τ)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">model (generic function with 2 methods)</code></pre><h2 id="Set-Parameter-Bounds"><a class="docs-heading-anchor" href="#Set-Parameter-Bounds">Set Parameter Bounds</a><a id="Set-Parameter-Bounds-1"></a><a class="docs-heading-anchor-permalink" href="#Set-Parameter-Bounds" title="Permalink"></a></h2><p>Specifying lower and upper bounds for the parameters is necessary to prevent the MLE and MAP  estimators from searching invalid regions of the parameter space. </p><pre><code class="language-julia hljs">lb = [0,0,0]
ub = [10, 10, minimum(rts)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
 10.0
 10.0
  0.38536466033318884</code></pre><h2 id="MLE"><a class="docs-heading-anchor" href="#MLE">MLE</a><a id="MLE-1"></a><a class="docs-heading-anchor-permalink" href="#MLE" title="Permalink"></a></h2><p>MLE is performed via the function <code>maximum_likelihood</code>.</p><pre><code class="language-julia hljs">mle_estimate = maximum_likelihood(model(rts); lb, ub)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModeResult with maximized lp of -7.62
[1.4415815007444206, 0.6990063775377101, 0.32611139519154697]</code></pre><h2 id="MAP"><a class="docs-heading-anchor" href="#MAP">MAP</a><a id="MAP-1"></a><a class="docs-heading-anchor-permalink" href="#MAP" title="Permalink"></a></h2><p>MAP is performed via the function <code>maximum_a_posteriori</code>.</p><pre><code class="language-julia hljs">map_estimate = maximum_a_posteriori(model(rts); lb, ub)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModeResult with maximized lp of -8.20
[1.4488716348067336, 0.7022870580892084, 0.3255810892442324]</code></pre><p>In both cases, the estimates are in the proximity of the data-generating values. </p><h2 id="Accessing-Estimates"><a class="docs-heading-anchor" href="#Accessing-Estimates">Accessing Estimates</a><a id="Accessing-Estimates-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-Estimates" title="Permalink"></a></h2><p>The estimates are located in the field <code>values</code>, which can be accessed as follows:</p><pre><code class="language-julia hljs">map_estimate.values</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Named Vector{Float64}
A  │ 
───┼─────────
ν  │  1.44887
α  │ 0.702287
τ  │ 0.325581</code></pre><p>which returns a named vector. To obtain a regular vector, append <code>.array</code> to the code above.</p><h2 id="Seeding-MCMC-Sampler"><a class="docs-heading-anchor" href="#Seeding-MCMC-Sampler">Seeding MCMC Sampler</a><a id="Seeding-MCMC-Sampler-1"></a><a class="docs-heading-anchor-permalink" href="#Seeding-MCMC-Sampler" title="Permalink"></a></h2><p>You can seed the MCMC sampler as illustrated below:</p><pre><code class="language-julia hljs">chain = sample(model, NUTS(), 1_000; initial_params=map_estimate.values.array)</code></pre><p>Additional details can be found in the <a href="https://turinglang.org/docs/versions/v0.33.0/tutorials/docs-17-mode-estimation/index.html">Turing documentation</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cddm/">« Circular Drift Diffusion Model (CDDM)</a><a class="docs-footer-nextpage" href="../turing_simple/">Simple Bayesian Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 10 July 2024 19:14">Wednesday 10 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
