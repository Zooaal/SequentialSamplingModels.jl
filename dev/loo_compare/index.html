<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PSIS-LOO · SequentialSamplingModels</title><meta name="title" content="PSIS-LOO · SequentialSamplingModels"/><meta property="og:title" content="PSIS-LOO · SequentialSamplingModels"/><meta property="twitter:title" content="PSIS-LOO · SequentialSamplingModels"/><meta name="description" content="Documentation for SequentialSamplingModels."/><meta property="og:description" content="Documentation for SequentialSamplingModels."/><meta property="twitter:description" content="Documentation for SequentialSamplingModels."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="SequentialSamplingModels logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SequentialSamplingModels</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Single Choice Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../ex_gaussian/">Ex-Gaussian</a></li><li><a class="tocitem" href="../shifted_lognormal/">Shifted Log Normal</a></li><li><a class="tocitem" href="../wald/">Wald</a></li><li><a class="tocitem" href="../wald_mixture/">Wald Mixture</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Multi-choice Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-2-1"><span class="docs-label">Single Attribute Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DDM/">Drift Diffusion Model (DDM)</a></li><li><a class="tocitem" href="../lca/">Leaky Competing Accumulator (LCA)</a></li><li><a class="tocitem" href="../lba/">Linear Ballistic Accumulator (LBA)</a></li><li><a class="tocitem" href="../lnr/">Log Normal Race (LNR)</a></li><li><a class="tocitem" href="../poisson_race/">Poisson Race</a></li><li><a class="tocitem" href="../rdm/">Racing Diffusion Model (RDM)</a></li><li><a class="tocitem" href="../stDDM/">Starting-time Drift Diffusion Model (stDDM)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2-2"><span class="docs-label">Multi-attribute Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../maaDDM/">Muti-attribute Attentional Drift Diffusion Model</a></li><li><a class="tocitem" href="../mdft/">Multi-attribute Decision Field Theory</a></li><li><a class="tocitem" href="../mlba/">Multi-attribute Linear Ballistic Accumulator</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Alternative Geometries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../cddm/">Circular Drift Diffusion Model (CDDM)</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Parameter Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mode_estimation/">Mode Estimation</a></li><li><a class="tocitem" href="../turing_simple/">Simple Bayesian Model</a></li><li><a class="tocitem" href="../turing_advanced/">Advanced Model Specification</a></li><li><a class="tocitem" href="../turing_hierarchical/">Hierarchical Models</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Model Comparison</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bayes_factor/">Bayes Factors</a></li><li class="is-active"><a class="tocitem" href>PSIS-LOO</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Data-Generating-Model"><span>Data-Generating Model</span></a></li><li><a class="tocitem" href="#Specify-Turing-Models"><span>Specify Turing Models</span></a></li><li><a class="tocitem" href="#Estimate-the-Parameters"><span>Estimate the Parameters</span></a></li><li><a class="tocitem" href="#Compute-PSIS-LOO"><span>Compute PSIS-LOO</span></a></li><li><a class="tocitem" href="#Compare-Models"><span>Compare Models</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../predictive_distributions/">Predictive Distributions</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Plotting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../basic_plot_example/">Basic Example</a></li><li><a class="tocitem" href="../layout/">Changing the Layout</a></li><li><a class="tocitem" href="../plot_model/">Plot Model Process</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../developer_guide/">Developer Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Model Comparison</a></li><li class="is-active"><a href>PSIS-LOO</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PSIS-LOO</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/itsdfish/SequentialSamplingModels.jl/blob/master/docs/src/loo_compare.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Computing-Model-Comparison-using-PSIS-LOO"><a class="docs-heading-anchor" href="#Computing-Model-Comparison-using-PSIS-LOO">Computing Model Comparison using PSIS-LOO</a><a id="Computing-Model-Comparison-using-PSIS-LOO-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-Model-Comparison-using-PSIS-LOO" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>We are often interested in comparing how well different models account for the same data. In this tutorial, we will compare models based on their expected log pointwise predictive density (ELPD), which we will estimate using Pareto smoothed importance sampling leave-one-out cross-validation (PSIS-LOO).</p><p>First, we&#39;ll simulate data from a <a href="../api/#SequentialSamplingModels.LBA"><code>LBA</code></a> with fixed parameters. Then, we&#39;ll define three LBA models with different fixed values for the <code>k</code> parameter. Finally, we&#39;ll use <a href="https://docs.juliahub.com/General/ParetoSmooth/stable/">ParetoSmooth.jl</a> to perform model comparison via PSIS-LOO.</p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>Before proceeding, we will load the required packages.</p><pre><code class="language-julia hljs">using Random
using SequentialSamplingModels
using LinearAlgebra
using ParetoSmooth
using Turing</code></pre><h2 id="Data-Generating-Model"><a class="docs-heading-anchor" href="#Data-Generating-Model">Data-Generating Model</a><a id="Data-Generating-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Generating-Model" title="Permalink"></a></h2><p>The next step is to generate simulated data for comparing the models. Here, we&#39;ll use an LBA as the true data-generating model:</p><pre><code class="language-julia hljs">Random.seed!(5000)

dist = LBA(ν=[3.0, 2.0], A=0.8, k=0.3, τ=0.3)
data = rand(dist, 1000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(choice = [1, 1, 1, 1, 1, 2, 1, 1, 1, 2  …  1, 1, 1, 1, 1, 1, 1, 1, 2, 1], rt = [0.5537064050410118, 0.38629170185227296, 0.637280655039369, 0.5448903749539002, 0.5952443705536006, 0.37945657633479085, 0.41796892609364245, 0.6285830144194395, 0.4844343165181269, 0.4595476942984271  …  0.5452492007091214, 0.4832630477233871, 0.39554491474077214, 0.4134086615325262, 0.5548783467911398, 0.5048770131987131, 0.5318772546839357, 0.3938795055279204, 0.3787803046977727, 0.3957807741556064])</code></pre><h2 id="Specify-Turing-Models"><a class="docs-heading-anchor" href="#Specify-Turing-Models">Specify Turing Models</a><a id="Specify-Turing-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Specify-Turing-Models" title="Permalink"></a></h2><p>The following code block defines the model along with its prior distributions using Turing.jl. We&#39;ll use this model with different fixed values for the <code>k</code> parameter.</p><pre><code class="language-julia hljs">@model function model_LBA(data, k; min_rt=minimum(data.rt))
    # Priors
    ν ~ MvNormal(fill(3.0, 2), I * 2)
    A ~ truncated(Normal(0.8, 0.4), 0.0, Inf)
    τ ~ Uniform(0.0, min_rt)

    # Likelihood
    data ~ LBA(; ν, A, k, τ)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">model_LBA (generic function with 2 methods)</code></pre><h2 id="Estimate-the-Parameters"><a class="docs-heading-anchor" href="#Estimate-the-Parameters">Estimate the Parameters</a><a id="Estimate-the-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-the-Parameters" title="Permalink"></a></h2><p>Now we&#39;ll estimate the parameters using three different fixed <code>k</code> values:</p><pre><code class="language-julia hljs">chain_LBA1 = sample(model_LBA(data, 2.0), NUTS(), 1000)
chain_LBA2 = sample(model_LBA(data, 0.3), NUTS(), 1000)
chain_LBA3 = sample(model_LBA(data, 1.0), NUTS(), 1000)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Chains MCMC chain (1000×16×1 Array{Float64, 3}):

Iterations        = 501:1:1500
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 22.05 seconds
Compute duration  = 22.05 seconds
parameters        = ν[1], ν[2], A, τ
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
 <span class="sgr1"> parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
 <span class="sgr90">     Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

        ν[1]    3.5722    0.2951    0.0264   125.9596   245.3104    1.0018     ⋯
        ν[2]    2.8159    0.2479    0.0220   127.9913   202.9393    1.0026     ⋯
           A    0.6242    0.2076    0.0185   124.1135   226.9220    1.0026     ⋯
           τ    0.1667    0.0058    0.0004   193.3547   202.8446    1.0031     ⋯
</span><span class="sgr36">                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
 </span><span class="sgr90">     Symbol   Float64   Float64   Float64   Float64   Float64

        ν[1]    3.0228    3.3484    3.5719    3.7839    4.1740
        ν[2]    2.3496    2.6278    2.8189    2.9936    3.2953
           A    0.2273    0.4716    0.6328    0.7751    1.0210
           τ    0.1557    0.1627    0.1665    0.1705    0.1786
</span></span></code></pre><h2 id="Compute-PSIS-LOO"><a class="docs-heading-anchor" href="#Compute-PSIS-LOO">Compute PSIS-LOO</a><a id="Compute-PSIS-LOO-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-PSIS-LOO" title="Permalink"></a></h2><p>Next we will use the <code>psis_loo</code> function to compute the PSIS-LOO for each model:</p><pre><code class="language-julia hljs">res1 = psis_loo(model_LBA(data, 2.0), chain_LBA1)
res2 = psis_loo(model_LBA(data, 0.3), chain_LBA2)
res3 = psis_loo(model_LBA(data, 1.0), chain_LBA3)
show(stdout, MIME&quot;text/plain&quot;(), ans)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: No source provided for samples; variables are assumed to be from a Markov Chain. If the samples are independent, specify this with keyword argument `source=:other`.
[ Info: No source provided for samples; variables are assumed to be from a Markov Chain. If the samples are independent, specify this with keyword argument `source=:other`.
[ Info: No source provided for samples; variables are assumed to be from a Markov Chain. If the samples are independent, specify this with keyword argument `source=:other`.
┌ Warning: Some Pareto k values are high (&gt;.7), indicating PSIS has failed to approximate the true distribution.
└ @ ParetoSmooth ~/.julia/packages/ParetoSmooth/Q1hGp/src/InternalHelpers.jl:50
Results of PSIS-LOO-CV with 1000 Monte Carlo samples and 1 data points. Total Monte Carlo SE of NaN.
┌───────────┬────────┬──────────┬────────┬─────────┐
│           │  total │ se_total │   mean │ se_mean │
├───────────┼────────┼──────────┼────────┼─────────┤
│   cv_elpd │ 360.46 │      NaN │ 360.46 │     NaN │
│ naive_lpd │ 362.43 │      NaN │ 362.43 │     NaN │
│     p_eff │   1.98 │      NaN │   1.98 │     NaN │
└───────────┴────────┴──────────┴────────┴─────────┘</code></pre><h2 id="Compare-Models"><a class="docs-heading-anchor" href="#Compare-Models">Compare Models</a><a id="Compare-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Compare-Models" title="Permalink"></a></h2><p>Finally, we can compare the models using the <code>loo_compare</code> function:</p><pre><code class="language-julia hljs">loo_compare((LBA1 = res1, LBA2 = res2, LBA3 = res3))
show(stdout, MIME&quot;text/plain&quot;(), ans)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌──────┬─────────┬────────┬────────┐
│      │ cv_elpd │ cv_avg │ weight │
├──────┼─────────┼────────┼────────┤
│ LBA2 │    0.00 │   0.00 │   1.00 │
│ LBA3 │  -17.81 │ -17.81 │   0.00 │
│ LBA1 │  -24.84 │ -24.84 │   0.00 │
└──────┴─────────┴────────┴────────┘</code></pre><p>Here we indeed correctly identified the generative model we simulated. It is of note that some researchers have criticized using model comparison metrics such as leave-one-out cross-validation. See Gronau et al. (2019) for more information.</p><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><p>Gronau, Q. F., &amp; Wagenmakers, E. J. (2019). Limitations of Bayesian leave-one-out cross-validation for model selection. Computational brain &amp; behavior, 2, 1-11.</p><p>Vehtari, A., Gelman, A. &amp; Gabry, J. Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Stat Comput 27, 1413–1432 (2017).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bayes_factor/">« Bayes Factors</a><a class="docs-footer-nextpage" href="../predictive_distributions/">Predictive Distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 10 July 2024 14:29">Wednesday 10 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
